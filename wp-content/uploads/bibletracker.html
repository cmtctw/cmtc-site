<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è–ç¶“é–±è®€é€²åº¦è¨˜éŒ„</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .container { width: 60%; text-align: left; margin-left: 40px; padding-left: 40px; }
        .section-title { font-size: 26px; font-weight: bold; margin-top: 40px; margin-bottom: 20px; }
        .book { margin-bottom: 20px; font-size: 22px; font-weight: bold; }
        .old-testament { color: green; }
        .new-testament { color: red; }
        .chapter { display: inline-block; margin: 5px; padding: 8px; cursor: pointer; border: 1px solid #ccc; font-size: 18px; }
        .read { background-color: lightgreen; }
        .progress { font-size: 20px; margin-top: 30px; font-weight: bold; }
        .book strong { font-size: 24px; }
        button { margin-top: 10px; padding: 10px; font-size: 16px; cursor: pointer; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“– è–ç¶“é€²åº¦è¨˜éŒ„</h1>
        <div id="app"></div>
    </div>

    <script type="text/babel" data-presets="react">
        const oldTestamentBooks = {
            "å‰µä¸–è¨˜": 50, "å‡ºåŸƒåŠè¨˜": 40, "åˆ©æœªè¨˜": 27, "æ°‘æ•¸è¨˜": 36, "ç”³å‘½è¨˜": 34,
            "ç´„æ›¸äºè¨˜": 24, "å£«å¸«è¨˜": 21, "è·¯å¾—è¨˜": 4, "æ’’æ¯è€³è¨˜ä¸Š": 31, "æ’’æ¯è€³è¨˜ä¸‹": 24,
            "åˆ—ç‹ç´€ä¸Š": 22, "åˆ—ç‹ç´€ä¸‹": 25, "æ­·ä»£å¿—ä¸Š": 29, "æ­·ä»£å¿—ä¸‹": 36,
            "ä»¥æ–¯æ‹‰è¨˜": 10, "å°¼å¸Œç±³è¨˜": 13, "ä»¥æ–¯å¸–è¨˜": 10, "ç´„ä¼¯è¨˜": 42,
            "è©©ç¯‡": 150, "ç®´è¨€": 31, "å‚³é“æ›¸": 12, "é›…æ­Œ": 8,
            "ä»¥è³½äºæ›¸": 66, "è€¶åˆ©ç±³æ›¸": 52, "è€¶åˆ©ç±³å“€æ­Œ": 5, "ä»¥è¥¿çµæ›¸": 48, "ä½†ä»¥ç†æ›¸": 12,
            "ä½•è¥¿é˜¿æ›¸": 14, "ç´„ç¥æ›¸": 3, "é˜¿æ‘©å¸æ›¸": 9, "ä¿„å·´åº•äºæ›¸": 1, "ç´„æ‹¿æ›¸": 4,
            "å½Œè¿¦æ›¸": 7, "é‚£é´»æ›¸": 3, "å“ˆå·´è°·æ›¸": 3, "è¥¿ç•ªé›…æ›¸": 3, "å“ˆè©²æ›¸": 2,
            "æ’’è¿¦åˆ©äºæ›¸": 14, "ç‘ªæ‹‰åŸºæ›¸": 4
        };

        const newTestamentBooks = {
            "é¦¬å¤ªç¦éŸ³": 28, "é¦¬å¯ç¦éŸ³": 16, "è·¯åŠ ç¦éŸ³": 24, "ç´„ç¿°ç¦éŸ³": 21,
            "ä½¿å¾’è¡Œå‚³": 28, "ç¾…é¦¬æ›¸": 16, "å“¥æ—å¤šå‰æ›¸": 16, "å“¥æ—å¤šå¾Œæ›¸": 13,
            "åŠ æ‹‰å¤ªæ›¸": 6, "ä»¥å¼—æ‰€æ›¸": 6, "è…“ç«‹æ¯”æ›¸": 4, "æ­Œç¾…è¥¿æ›¸": 4,
            "å¸–æ’’ç¾…å°¼è¿¦å‰æ›¸": 5, "å¸–æ’’ç¾…å°¼è¿¦å¾Œæ›¸": 3, "ææ‘©å¤ªå‰æ›¸": 6, "ææ‘©å¤ªå¾Œæ›¸": 4,
            "æå¤šæ›¸": 3, "è…“åˆ©é–€æ›¸": 1, "å¸Œä¼¯ä¾†æ›¸": 13, "é›…å„æ›¸": 5,
            "å½¼å¾—å‰æ›¸": 5, "å½¼å¾—å¾Œæ›¸": 3, "ç´„ç¿°ä¸€æ›¸": 5, "ç´„ç¿°äºŒæ›¸": 1,
            "ç´„ç¿°ä¸‰æ›¸": 1, "çŒ¶å¤§æ›¸": 1, "å•Ÿç¤ºéŒ„": 22
        };

        function BibleTracker() {
            const [readChapters, setReadChapters] = React.useState(() => {
                return JSON.parse(localStorage.getItem("bibleProgress")) || {};
            });

            const toggleChapter = (book, chapter) => {
                const newReadChapters = { ...readChapters };
                newReadChapters[book] = newReadChapters[book] || [];
                newReadChapters[book][chapter] = !newReadChapters[book][chapter];
                setReadChapters(newReadChapters);
                localStorage.setItem("bibleProgress", JSON.stringify(newReadChapters));
            };

            const downloadBackup = () => {
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(readChapters));
                const downloadAnchorNode = document.createElement("a");
                downloadAnchorNode.setAttribute("href", dataStr);
                downloadAnchorNode.setAttribute("download", "bible_progress_backup.json");
                document.body.appendChild(downloadAnchorNode);
                downloadAnchorNode.click();
                downloadAnchorNode.remove();
            };

            const uploadBackup = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const uploadedData = JSON.parse(e.target.result);
                        setReadChapters(uploadedData);
                        localStorage.setItem("bibleProgress", JSON.stringify(uploadedData));
                        alert("å‚™ä»½å·²æˆåŠŸä¸Šå‚³ä¸¦æ¢å¾©ï¼");
                    } catch (error) {
                        alert("ä¸Šå‚³çš„æ–‡ä»¶æ ¼å¼éŒ¯èª¤ï¼");
                    }
                };
                reader.readAsText(file);
            };

            return (
                <div>
                    <button onClick={downloadBackup}>ä¸‹è¼‰é€²åº¦å‚™ä»½</button>
                    <input type="file" accept=".json" onChange={uploadBackup} />
                    <div className="section-title">èˆŠç´„è–ç¶“</div>
                    {Object.entries(oldTestamentBooks).map(([book, chapters]) => (
                        <div key={book} className="book old-testament">
                            <strong>{book}</strong>
                            <div>
                                {[...Array(chapters).keys()].map(i => (
                                    <span key={i} className={`chapter ${readChapters[book] && readChapters[book][i] ? "read" : ""}`}
                                          onClick={() => toggleChapter(book, i)}>
                                        {i + 1}
                                    </span>
                                ))}
                            </div>
                        </div>
                    ))}
                    <div className="section-title">æ–°ç´„è–ç¶“</div>
                    {Object.entries(newTestamentBooks).map(([book, chapters]) => (
                        <div key={book} className="book new-testament">
                            <strong>{book}</strong>
                            <div>
                                {[...Array(chapters).keys()].map(i => (
                                    <span key={i} className={`chapter ${readChapters[book] && readChapters[book][i] ? "read" : ""}`}
                                          onClick={() => toggleChapter(book, i)}>
                                        {i + 1}
                                    </span>
                                ))}
                            </div>
                        </div>
                    ))}
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById("app")).render(<BibleTracker />);
    </script>
</body>
</html>
